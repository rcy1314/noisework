<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NOISEä¹¦ç­¾ç´¢å¼•</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="logo.png" type="image/png" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      min-height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #111; /* è®¾ç½®èƒŒæ™¯ä¸ºæš—é»‘è‰² */
      color: #fff; /* è®¾ç½®æ–‡å­—ä¸ºç™½è‰² */
    }

    .container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .search-container {
      display: flex;
      align-items: center;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      width: 100%;
      max-width: 800px;
      margin-bottom: 10px;
    }

    .search-category {
      margin-right: 10px;
      padding: 10px;
      font-size: 15px;
      background-color:#333; /* è®¾ç½®åˆ†ç±»æœç´¢æ¡†èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰² */
      color: #fff; /* è®¾ç½®åˆ†ç±»æœç´¢æ¡†æ–‡å­—é¢œè‰²ä¸ºæš—é»‘è‰² */
      border: none;
      flex: 1; /* è®¾ç½®ä¸ºè‡ªåŠ¨æ‰©å±•å‰©ä½™å®½åº¦ */
      max-width: 200px; /* è®¾ç½®æœ€å¤§å®½åº¦ä¸º200px */
    }

    .search-input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      background-color: #333; /* è®¾ç½®è¾“å…¥æ¡†èƒŒæ™¯é¢œè‰² */
      color: #fff; /* è®¾ç½®è¾“å…¥æ¡†æ–‡å­—é¢œè‰² */
      border: none;
      width: 100%; /* è®¾ç½®è¾“å…¥æ¡†å®½åº¦ä¸º100% */
    }

    .search-button {
      margin-left: 10px;
      padding: 10px 20px;
      background-color: #007bff; /* ä¿®æ”¹ä¸ºè“è‰² */
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .clear-btn {
      margin-left: 10px;
      padding: 10px 20px;
      background-color: #dc3545; /* ä¿®æ”¹ä¸ºçº¢è‰² */
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .show-all-btn {
      margin-left: 10px;
      padding: 10px 20px;
      background-color: #007bff; /* ä¿®æ”¹ä¸ºè“è‰² */
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .search-results-container {
      width: 100%;
      max-width: 800px;
      margin-top: 10px;
      padding: 20px;
      background-color: rgba(255, 255, 255, 0.1); /* è®¾ç½®æœç´¢ç»“æœå®¹å™¨çš„èƒŒæ™¯é¢œè‰²ä¸ºåŠé€æ˜ç™½è‰² */
      border-radius: 5px;
      overflow: auto; /* æ·»åŠ æ»šåŠ¨æ¡ */
      color: #fff; /* è®¾ç½®æœç´¢ç»“æœæ–‡å­—ä¸ºç™½è‰² */
      position: relative; /* æ·»åŠ ç›¸å¯¹å®šä½ */
    }

    .search-results ul {
      padding: 0;
      list-style-type: none;
    }

    .search-results li {
      margin-bottom: 10px;
    }

    .search-results a {
      text-decoration: none;
      color: #fff; /* ä¿®æ”¹ä¸ºç™½è‰² */
      transition: color 0.3s; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
    }

    .search-results a:hover {
      color: orange; /* è®¾ç½®é¼ æ ‡æ‚¬åœæ—¶çš„æ–‡æœ¬é¢œè‰²ä¸ºæ©™è‰² */
    }

    .title {
      text-align: center;
      font-size: 50px;
      margin-bottom: 10px;
      margin-top: 50px; /* å¾€ä¸Šç§»åŠ¨æ ‡é¢˜ */
    }
    .subtitle {
      text-align: center;
      font-size: 16px;
      margin-bottom: 10px;
      margin-top: 20px; /* å¾€ä¸Šç§»åŠ¨å­æ ‡é¢˜ */
    }

    footer {
      text-align: center;
      width: 100%;
      color: #fff;
    }

    /* éšè—åˆ†ç±»æœç´¢æ¡†çš„æ ·å¼ */
    @media only screen and (max-width: 600px) {
      .search-category {
        display: none;
      }
    }

    .announcement {
      font-size: 15px;
      text-align: center;
      margin-bottom: 10px;
    }

    .return-button {
      position: fixed;
      bottom: 10px;
      right: 25px;
      padding: 8px;
      background-color: #0e0e0e52;
      color: #090909;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      opacity: 0.8;
      transition: opacity 0.3s;
      display: none;
      font-size: 24px; /* å¢å¤§æŒ‰é’®çš„å­—ä½“å¤§å° */
    }

    .return-button:hover {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 style="color:rgb(248, 249, 251);" class="title">Book Mark ç´¢å¼•</h1>
    <p class="subtitle">ä»å·²æ”¶å½•çš„ä¸Šä¸‡ä¸ªä¹¦ç­¾ä¸­æœç´¢</p><br>
    <div class="search-container">
      <select id="search-category" class="search-category">
        <option value="æœ¬ç«™æœç´¢">æœ¬ç«™æœç´¢</option>
        <option value="è°·æ­Œæœç´¢">è°·æ­Œæœç´¢</option>
        <option value="å¿…åº”æœç´¢">å¿…åº”æœç´¢</option>
        <option value="DuckDuckæœç´¢">DuckDuckæœç´¢</option>
        <option value="ç™¾åº¦æœç´¢">ç™¾åº¦æœç´¢</option>
        <option value="yandexæœç´¢">Yandexæœç´¢</option>
        <option value="å“”å“©å“”å“©æœç´¢">å“”å“©å“”å“©æœç´¢</option>
        <option value="youtubeæœç´¢">Youtubeæœç´¢</option>
        <option value="githubæœç´¢">Githubæœç´¢</option>
      </select>
      <input type="text" id="search-input" class="search-input" placeholder="è¾“å…¥å…³é”®å­—">
      <button id="search-button" class="search-button">æœç´¢</button>
      <button id="clear-button" class="clear-btn">æ¸…é™¤</button>
      <button id="show-all-button" class="show-all-btn">æ˜¾ç¤ºå…¨éƒ¨</button>
    </div>
    <div class="search-results-container">
      <div class="announcement" id="announcement">ğŸª§ï¼šæ¬¢è¿è®¿é—®ï¼æ³¨æ„ï¼æœç´¢æ•°æ®éœ€è¦ç¼“å­˜æ‰èƒ½å¿«é€ŸåŠ è½½ï¼Œå¦‚æœ‰æ— æ³•ç”¨å…³é”®è¯æ£€ç´¢çš„ä¿¡æ¯æ—¶è¯·ç‚¹å‡»æ˜¾ç¤ºå…¨éƒ¨ï¼</div>
      <div class="search-results" id="search-results"></div>
      <button class="return-button" id="return-button" title="è¿”å›é¡¶éƒ¨">ğŸ‘†</button>
    </div>
  </div>

  <footer>
    <p><a href="https://noisework.cn" style="color: white;">æ•°æ®æ¥è‡ªNoiseå¯¼èˆªç«™ã€notionæ”¶å½•é¡µåŠæµè§ˆå™¨ä¹¦ç­¾æ”¶è—ç­‰</a></p>
  </footer>

  <script>
    // è·å–æœç´¢å…³é”®å­—å’Œåˆ†ç±»
    const searchInput = document.getElementById('search-input');
    const searchButton = document.getElementById('search-button');
    const searchCategory = document.getElementById('search-category');
    const clearButton = document.getElementById('clear-button');
    const showAllButton = document.getElementById('show-all-button');
    const announcement = document.getElementById('announcement');
    const returnButton = document.getElementById('return-button');
    const searchResultsContainer = document.getElementById('search-results');

    // æŒ‰ä¸‹å›è½¦é”®è§¦å‘æœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
    searchInput.addEventListener('keydown', event => {
      if (event.key === 'Enter') {
        searchButton.click();
      }
    });

    searchButton.addEventListener('click', async () => {
      const keyword = searchInput.value.toLowerCase();
      const category = searchCategory.value;

      // æ¸…ç©ºæœç´¢ç»“æœ
      searchResultsContainer.innerHTML = '';

      // å¦‚æœç”¨æˆ·æœªè¾“å…¥å…³é”®è¯ï¼Œåˆ™æç¤ºç”¨æˆ·è¾“å…¥å…³é”®è¯
      if (keyword.trim() === '') {
        alert('è¯·è¾“å…¥æ‚¨çš„å…³é”®è¯');
        return;
      }

      if (category === 'æœ¬ç«™æœç´¢') {
        // éšè—å…¬å‘Š
        announcement.style.display = 'none';

        // å®šä¹‰å¤šä¸ªæ•°æ®æº
        const dataSources = ['https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Notionmark.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/AI.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Opensource.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Notiongo.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Daohang.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Marks.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Rssbook.json'];

        // å­˜å‚¨æ‰€æœ‰çš„æœç´¢ç»“æœ
        let allSearchResults = [];

        // å®šä¹‰æœç´¢å‡½æ•°
        const searchDataSources = async () => {
          for (const dataSource of dataSources) {
            try {
              const response = await fetch(dataSource);
              const data = await response.json();

              if (Array.isArray(data)) {
                // éå†æ•°æ®é¡¹è¿›è¡ŒåŒ¹é…
                data.forEach(item => {
                  if (item.name && item.URL) {
                    const itemName = item.name.toLowerCase();
                    const itemURL = item.URL.toLowerCase();
                    const itemDescription = item.description ? item.description.toLowerCase() : '';
                    const itemTitle = item.title ? item.title.toLowerCase() : '';
                    const itemText = item.text ? item.text.toLowerCase() : '';
                    const itemTags = item.tags ? item.tags.toLowerCase() : '';

                    // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤šä¸ªå­—ç¬¦çš„æ¨¡ç³ŠåŒ¹é…
                    const regex = new RegExp(keyword.split('').join('.*'), 'i'); // ä¸åŒºåˆ†å¤§å°å†™

                    if (itemName.match(regex) || itemURL.match(regex) || itemDescription.match(regex) || itemTitle.match(regex) || itemText.match(regex) || itemTags.match(regex)) {
                      allSearchResults.push({ name: item.name, URL: item.URL, description: item.description });
                    }
                  } else if (item.links) {
                    // å¤„ç†Daohang.jsonçš„æ•°æ®ç»“æ„
                    item.links.forEach(link => {
                      const itemTitle = link.title.toLowerCase();
                      const itemURL = link.url.toLowerCase();
                      const itemDescription = link.description ? link.description.toLowerCase() : '';

                      // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤šä¸ªå­—ç¬¦çš„æ¨¡ç³ŠåŒ¹é…
                      const regex = new RegExp(keyword.split('').join('.*'), 'i'); // ä¸åŒºåˆ†å¤§å°å†™

                      if (itemTitle.match(regex) || itemURL.match(regex) || itemDescription.match(regex)) {
                        allSearchResults.push({ name: link.title, URL: link.url, description: link.description });
                      }
                    });
                  } else {
                    // å¤„ç†Marks.jsonçš„æ•°æ®ç»“æ„
                    const itemURL = item.url.toLowerCase();
                    const itemTitle = item.title ? item.title.toLowerCase() : '';
                    const itemNotes = item.notes ? item.notes.toLowerCase() : '';
                    const itemText = item.text ? item.text.toLowerCase() : '';
                    const itemTaxonomy = item.taxonomy ? item.taxonomy.toLowerCase() : '';
                    const itemDescription = item.description ? item.description.toLowerCase() : '';
                    const itemDescription2 = item.Description ? item.Description.toLowerCase() : '';
                    const itemTags = item.tags ? item.tags.toLowerCase() : '';
                    const itemTitle2 = item.title ? item.title.toLowerCase() : '';

                    // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤šä¸ªå­—ç¬¦çš„æ¨¡ç³ŠåŒ¹é…
                    const regex = new RegExp(keyword.split('').join('.*'), 'i'); // ä¸åŒºåˆ†å¤§å°å†™

                    if (itemURL.match(regex) || itemTitle.match(regex) || itemNotes.match(regex) || itemText.match(regex) || itemTaxonomy.match(regex) || itemDescription.match(regex) || itemDescription2.match(regex) || itemTags.match(regex) || itemTitle2.match(regex)) {
                      allSearchResults.push({ name: item.title, URL: item.url, description: item.description, Description: item.Description });
                    }
                  }
                });
              }
            } catch (error) {
              console.log('åŠ è½½æ•°æ®å¤±è´¥:', error);
            }
          }

          // æ˜¾ç¤ºæœç´¢ç»“æœ
          if (allSearchResults.length > 0) {
            allSearchResults.forEach(item => {
              const resultItem = document.createElement('div');
              const link = document.createElement('a');
              link.href = item.URL;
              link.target = "_blank"; // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥
              link.innerHTML = item.name.replace(new RegExp(`(${keyword})`, 'ig'), '<span style="color: lightblue;">\$1</span>');
              resultItem.appendChild(link);

              if (item.description) {
                const description = document.createElement('p');
                description.textContent = item.description;
                resultItem.appendChild(description);
              }

              if (item.Description) {
                const description2 = document.createElement('p');
                description2.textContent = item.Description;
                resultItem.appendChild(description2);
              }

              resultItem.innerHTML += '<hr style="border-color: #fff; margin: 10px 0;">'; // æ·»åŠ åˆ†éš”ç¬¦
              searchResultsContainer.appendChild(resultItem);
            });
          } else {
            alert('æ— åŒ¹é…ç»“æœ');
          }
        };

        // æ‰§è¡Œæœç´¢
        await searchDataSources();

        // éšè—å…¬å‘Š
        announcement.style.display = 'none';

        // æ£€æŸ¥æœç´¢ç»“æœæ˜¯å¦è¶…å‡ºé¡µé¢é«˜åº¦ï¼Œæ˜¾ç¤ºæˆ–éšè—è¿”å›æŒ‰é’®
        checkSearchResultsHeight();
      } else {
        // æ ¹æ®é€‰æ‹©çš„åˆ†ç±»è°ƒç”¨ä¸åŒçš„æœç´¢å¼•æ“
        let searchUrl = '';
        switch (category) {
          case 'è°·æ­Œæœç´¢':
            searchUrl = `https://www.google.com/search?q=${encodeURIComponent(keyword)}`;
            break;
          case 'å¿…åº”æœç´¢':
            searchUrl = `https://www.bing.com/search?q=${encodeURIComponent(keyword)}`;
            break;
          case 'DuckDuckæœç´¢':
            searchUrl = `https://duckduckgo.com/?q=${encodeURIComponent(keyword)}`;
            break;
          case 'ç™¾åº¦æœç´¢':
            searchUrl = `https://www.baidu.com/s?wd=${encodeURIComponent(keyword)}`;
            break;
          case 'yandexæœç´¢':
            searchUrl = `https://yandex.com/search/?text=${encodeURIComponent(keyword)}`;
            break;
          case 'å“”å“©å“”å“©æœç´¢':
            searchUrl = `https://search.bilibili.com/all?keyword=${encodeURIComponent(keyword)}`;
            break;
          case 'youtubeæœç´¢':
            searchUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(keyword)}`;
            break;
          case 'githubæœç´¢':
            searchUrl = `https://github.com/search?q=${encodeURIComponent(keyword)}`;
            break;
          default:
            break;
        }

        if (searchUrl !== '') {
          window.open(searchUrl, '_blank');
        }
      }
    });

    clearButton.addEventListener('click', () => {
      searchInput.value = '';
      searchResultsContainer.innerHTML = '';
      announcement.style.display = 'block';
      returnButton.style.display = 'none';
    });

    showAllButton.addEventListener('click', async () => {
      searchResultsContainer.innerHTML = '';

      const dataSources = ['https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Notionmark.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/AI.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Opensource.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Notiongo.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Daohang.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Marks.json', 'https://jsd.onmicrosoft.cn/gh/rcy1314/noisework@master/soso/Rssbook.json'];

      for (const dataSource of dataSources) {
        try {
          const response = await fetch(dataSource);
          const data = await response.json();

          if (Array.isArray(data)) {
            data.forEach(item => {
              if (item.name && item.URL) {
                const resultItem = document.createElement('div');
                const link = document.createElement('a');
                link.href = item.URL;
                link.target = "_blank"; // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥
                link.innerHTML = item.name;
                resultItem.appendChild(link);

                if (item.description) {
                  const description = document.createElement('p');
                  description.textContent = item.description;
                  resultItem.appendChild(description);
                }

                if (item.Description) {
                  const description2 = document.createElement('p');
                  description2.textContent = item.Description;
                  resultItem.appendChild(description2);
                }

                resultItem.innerHTML += '<hr style="border-color: #fff; margin: 10px 0;">'; // æ·»åŠ åˆ†éš”ç¬¦
                searchResultsContainer.appendChild(resultItem);
              } else if (item.links) {
                item.links.forEach(link => {
                  const resultItem = document.createElement('div');
                  const linkElement = document.createElement('a');
                  linkElement.href = link.url;
                  linkElement.target = "_blank"; // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥
                  linkElement.innerHTML = link.title;
                  resultItem.appendChild(linkElement);

                  if (link.description) {
                    const description = document.createElement('p');
                    description.textContent = link.description;
                    resultItem.appendChild(description);
                  }

                  resultItem.innerHTML += '<hr style="border-color: #fff; margin: 10px 0;">'; // æ·»åŠ åˆ†éš”ç¬¦
                  searchResultsContainer.appendChild(resultItem);
                });
              } else {
                const resultItem = document.createElement('div');
                const link = document.createElement('a');
                link.href = item.url;
                link.target = "_blank"; // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥
                link.innerHTML = item.title;
                resultItem.appendChild(link);

                if (item.description) {
                  const description = document.createElement('p');
                  description.textContent = item.description;
                  resultItem.appendChild(description);
                }

                if (item.Description) {
                  const description2 = document.createElement('p');
                  description2.textContent = item.Description;
                  resultItem.appendChild(description2);
                }

                resultItem.innerHTML += '<hr style="border-color: #fff; margin: 10px 0;">'; // æ·»åŠ åˆ†éš”ç¬¦
                searchResultsContainer.appendChild(resultItem);
              }
            });
          }
        } catch (error) {
          console.log('åŠ è½½æ•°æ®å¤±è´¥:', error);
        }
      }

      // æ£€æŸ¥æœç´¢ç»“æœæ˜¯å¦è¶…å‡ºé¡µé¢é«˜åº¦ï¼Œæ˜¾ç¤ºæˆ–éšè—è¿”å›æŒ‰é’®
      checkSearchResultsHeight();
    });

    returnButton.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // æ£€æŸ¥æœç´¢æ¡†æ˜¯å¦ä¸ºç©º
    const checkSearchInput = () => {
      const keyword = searchInput.value.trim();
      if (keyword === '') {
        announcement.style.display = 'block';
      }
    };

    searchInput.addEventListener('input', checkSearchInput);

    // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºå…¬å‘Š
    window.addEventListener('load', () => {
      announcement.style.display = 'block';
    });

    // æ£€æŸ¥æœç´¢ç»“æœæ˜¯å¦è¶…å‡ºé¡µé¢é«˜åº¦ï¼Œæ˜¾ç¤ºæˆ–éšè—è¿”å›æŒ‰é’®
    const checkSearchResultsHeight = () => {
      const searchResultsHeight = searchResultsContainer.offsetHeight;

      if (searchResultsHeight > 6 * 40) {
        returnButton.style.display = 'block';
      } else {
        returnButton.style.display = 'none';
      }
    };

    window.addEventListener('resize', checkSearchResultsHeight);
    window.addEventListener('load', checkSearchResultsHeight);
  </script>
</body>
</html>
